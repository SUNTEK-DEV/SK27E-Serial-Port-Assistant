# 串口调试助手使用文档

## 应用简介

串口调试助手是一款SUNTEK团队开发用于Android设备的串口通信工具，支持通过串口与LED灯控制器和扫码器进行通信调试。

## 端口说明

本应用支持两个串口设备：

- **ttyS5** - LED灯控制器串口
  - 用于控制LED灯的显示、亮度调节等操作
  - 波特率：9600

- **ttyS11** - 扫码器串口
  - 用于接收扫码器的扫描数据
  - 波特率：9600

## 功能特性

### 1. 端口选择
- 支持选择 `/dev/ttyS5` 或 `/dev/ttyS11`
- 自动检测端口可用性，显示"可用"或"不可用"状态
- 下拉列表选择，操作简便

### 2. 波特率设置
- 默认波特率：9600
- 可根据设备要求修改波特率
- 支持标准波特率：9600, 19200, 38400, 57600, 115200

### 3. 串口控制
- **打开串口**：点击"打开串口"按钮，连接所选端口
- **关闭串口**：串口打开后，按钮变为"关闭串口"，点击即可断开连接
- 打开串口后，端口选择和波特率设置将被锁定，防止误操作

### 4. 数据接收
- 实时接收串口数据，带时间戳显示
- 显示格式：
  - 文本模式：显示可打印字符，不可打印字符以十六进制显示 `[XX]`
  - 每条数据前显示接收时间：`[HH:mm:ss.SSS]`
- 自动滚动到最新数据
- 支持长按选择复制接收的数据

### 5. 数据发送
- **文本模式**：直接输入文本内容发送
- **Hex模式**：点击"Hex发送"按钮切换为十六进制发送模式
  - 输入十六进制数据，如：`01 02 03 FF` 或 `010203FF`
  - 自动过滤空格
  - Hex发送模式会在接收区也以十六进制格式显示
- 每条发送的数据都会在接收区显示，带时间戳
- 发送成功后会显示发送的字节数

### 6. 其他功能
- **清空接收**：清空接收区所有数据
- **状态显示**：底部显示当前连接状态和错误信息
- **自动检查**：启动时自动检查端口设备是否存在

## 使用步骤

### 连接LED灯控制器 (ttyS5)

1. **选择端口**
   - 点击端口下拉列表
   - 选择 `/dev/ttyS5 (可用)` 或 `/dev/ttyS5 (不可用)`
   - 如果显示"不可用"，请检查设备权限

2. **设置波特率**
   - 确认波特率为 `9600`（默认值）
   - 如需修改，输入对应波特率值

3. **打开串口**
   - 点击"打开串口"按钮
   - 成功后会显示："已连接: /dev/ttyS5 @ 9600 baud"
   - 状态栏显示"已连接"状态

4. **发送LED控制指令**
   - 在发送区输入LED控制指令（参考LED通讯协议文档）
   - 根据指令格式选择"文本发送"或"Hex发送"
   - 点击"发送数据"按钮

5. **接收响应数据**
   - LED控制器返回的数据会显示在接收区
   - 每条数据带有时间戳
   - 可以查看LED控制器的响应状态

6. **关闭串口**
   - 调试完成后，点击"关闭串口"按钮
   - 断开串口连接

### 连接扫码器 (ttyS11)

1. **选择端口**
   - 点击端口下拉列表
   - 选择 `/dev/ttyS11 (可用)`

2. **设置波特率**
   - 确认波特率为 `9600`

3. **打开串口**
   - 点击"打开串口"按钮
   - 等待连接成功提示

4. **接收扫码数据**
   - 串口打开后，扫码器扫描的条码/二维码数据会自动显示在接收区
   - 每条数据带有时间戳：`[HH:mm:ss.SSS] RX: 扫码内容`
   - 可以实时查看扫码结果

5. **发送配置指令**（如需要）
   - 如果需要对扫码器进行配置，可以在发送区输入配置指令
   - 点击"发送数据"发送

6. **关闭串口**
   - 使用完成后，点击"关闭串口"断开连接

## 数据格式说明

### 文本模式
- 直接输入文本内容，如：`AT+CONFIG=1`
- 适合发送ASCII文本命令

### Hex模式
- 输入十六进制数据，格式示例：
  - `01 02 03 FF`（带空格）
  - `010203FF`（无空格）
  - `0A 0D`（回车换行）
- 自动过滤空格和大小写
- 适合发送二进制数据或协议数据包

### 接收数据显示
- **文本模式**：可打印字符正常显示，不可打印字符显示为 `[XX]` 格式
- **Hex模式**：所有数据以十六进制显示，如：`01 02 03 FF`

## 界面说明

```
┌─────────────────────────┐
│   串口调试助手          │
├─────────────────────────┤
│ 端口: [ttyS5 ▼]        │
│ 波特率: [9600]          │
│ [打开串口]              │
├─────────────────────────┤
│ 接收区:                 │
│ ┌─────────────────────┐ │
│ │ [10:23:45.123] RX:  │ │
│ │ 数据内容...         │ │
│ └─────────────────────┘ │
│ [清空接收] [Hex发送]    │
├─────────────────────────┤
│ 发送区:                 │
│ ┌─────────────────────┐ │
│ │ 输入要发送的数据    │ │
│ └─────────────────────┘ │
│ [发送数据]              │
├─────────────────────────┤
│ 状态: 已连接            │
└─────────────────────────┘
```

## 注意事项

### 权限要求
- 访问 `/dev/ttyS*` 设备需要相应的系统权限
- 如果应用无法打开串口，可能需要：
  1. **Root权限**：在已root的设备上运行
  2. **系统权限**：设备厂商已授权应用访问串口
  3. **SELinux策略**：需要调整SELinux策略允许访问串口设备

### 串口使用规则
1. **独占访问**：同一时刻只能有一个应用访问串口
2. **关闭连接**：使用完毕后务必关闭串口，释放资源
3. **异常处理**：如果连接异常，先关闭串口再重新打开

### 波特率设置
- 波特率必须与设备匹配，否则无法正常通信
- LED控制器和扫码器默认使用 **9600** 波特率
- 修改波特率后需要关闭串口并重新打开才能生效

### 数据发送
- 发送数据前确保串口已打开
- Hex模式下，确保输入的十六进制数据格式正确
- 如果发送失败，检查串口连接状态

### 数据接收
- 接收区最多显示可见内容，建议定期清空
- 接收到的数据会自动添加时间戳，方便调试
- 长按接收区文本可以选择复制

## 常见问题

### Q1: 端口显示"不可用"，无法打开串口
**A:** 
- 检查设备文件是否存在：`/dev/ttyS5` 或 `/dev/ttyS11`
- 检查应用是否有访问权限
- 尝试使用root权限运行应用

### Q2: 打开串口提示"串口打开失败"
**A:**
- 检查端口是否被其他应用占用
- 检查设备权限设置
- 尝试重启设备后再次打开

### Q3: 发送数据后没有响应
**A:**
- 检查波特率是否与设备匹配
- 确认发送的数据格式正确
- 检查设备是否正常工作
- 查看接收区是否有错误信息

### Q4: 扫码器数据接收不完整
**A:**
- 检查波特率设置（应为9600）
- 确认串口连接正常
- 检查扫码器配置是否正确

### Q5: Hex模式发送失败
**A:**
- 检查输入的十六进制数据格式是否正确
- 确保每两个字符代表一个字节（00-FF）
- 检查是否有非法字符

### Q6: 应用崩溃或无响应
**A:**
- 关闭串口后再退出应用
- 清理应用数据后重新安装
- 检查Android系统日志（logcat）获取错误信息

## LED控制器使用示例

### 示例1：查询LED状态
1. 选择端口：`ttyS5`
2. 打开串口
3. 发送区输入查询指令（参考LED通讯协议）
4. 点击"发送数据"
5. 接收区查看返回的状态信息

### 示例2：控制LED显示
1. 打开 `ttyS5` 串口
2. 切换到Hex模式（点击"Hex发送"）
3. 输入LED控制指令的十六进制数据
4. 发送数据，LED显示相应内容

## 扫码器使用示例

### 示例1：接收扫码数据
1. 选择端口：`ttyS11`
2. 打开串口
3. 使用扫码器扫描条码/二维码
4. 扫描结果自动显示在接收区，带时间戳

### 示例2：配置扫码器
1. 打开 `ttyS11` 串口
2. 发送配置指令（参考扫码器协议文档）
3. 接收配置响应，确认配置是否成功

## 技术支持

如遇到问题或需要技术支持，请：
1. 查看接收区的错误信息
2. 检查状态栏的提示信息
3. 查看Android系统日志（logcat）
4. 联系SUNTEK技术支持团队

## 版本信息

- 应用名称：串口调试助手
- 版本号：1.0
- 更新日期：2026.1.9

---

**注意**：使用串口通信前，请确保了解LED控制器和扫码器的通信协议，参考相关技术文档。

